{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_init","_carregarNegociacoes","setInterval","_importaNegociacoes","event","preventDefault","negociacao","_criaNegociacao","cadastra","then","adiciona","texto","mensagem","_limpaFormulario","catch","erro","lista","negociacoes","map","apaga","esvazia","importa","forEach","coluna","inverteOrdem","ordena","a","b","Negociacao","DateHelper","textToDate","value","parseInt","parseFloat","dateToText","Date","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n  constructor() {\n\n    let $ = document.querySelector.bind(document);\n    this._inputData = $('#data');\n    this._inputQuantidade = $('#quantidade');\n    this._inputValor = $('#valor');\n\n    this._ordemAtual = '';\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView($('#tabelaNegociacoes')),\n      'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($('#mensagemAlerta')),\n      'texto');\n\n    this._service = new NegociacaoService();\n\n    this._init();\n\n  }\n\n  _init() {\n    this._carregarNegociacoes();\n    setInterval(() => {\n      this._importaNegociacoes()\n    }, 3000)\n  }\n\n  adiciona(event) {\n\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n    this._service.cadastra(negociacao)\n      .then(mensagem => {\n        this._listaNegociacoes.adiciona(this._criaNegociacao());\n        this._mensagem.texto = mensagem;\n        this._limpaFormulario();\n      })\n      .catch(erro => this._mensagem.texto = erro);\n\n  }\n\n  _carregarNegociacoes() {\n    this._service\n      .lista()\n      .then(negociacoes =>\n        negociacoes.map(negociacao =>\n          this._listaNegociacoes.adiciona(negociacao)))\n      .catch(erro => this._mensagem.texto = erro);\n  }\n\n  apaga() {\n    this._service\n      .apaga()\n      .then(mensagem => {\n        this._listaNegociacoes.esvazia();\n        this._mensagem.texto = mensagem;\n      })\n      .catch(erro => this._mensagem.texto = erro);\n  }\n\n  _importaNegociacoes() {\n\n    this._service.importa(this._listaNegociacoes.negociacoes)\n      .then(negociacoes => {\n        negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\n        this._mensagem.texto = 'NegociacÃµes importadas com sucesso';\n      })\n      .catch(erro => this._mensagem.texto = erro);\n  }\n\n  ordena(coluna) {\n    if (this._ordemAtual == coluna) {\n      this._listaNegociacoes.inverteOrdem();\n    } else {\n      this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n    }\n    this._ordemAtual = coluna;\n  }\n\n  _criaNegociacao() {\n\n    return new Negociacao(\n      DateHelper.textToDate(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value));\n  }\n\n  _limpaFormulario() {\n\n    this._inputData.value = DateHelper.dateToText(new Date());\n    this._inputQuantidade.value = '1';\n    this._inputValor.value = '0.0';\n\n    this._inputData.focus();\n  }\n\n}"]}